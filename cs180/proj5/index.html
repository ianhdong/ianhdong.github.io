<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/cs180/css/styles.css">
    <script src="/cs180/js/hamburger.js" defer></script>


    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <title>CS 180 Project 5: Diffusion Models</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>

</head>


<body>
    <div class="content">

        <h1 align="middle">CS 180: Intro to Computer Vision and Computational Photography, Fall 2024</h1>
        <h1 align="middle"><a href="#5a">Project 5A: Fun with Diffusion Models</a>
        </h1>
        <h2 align="middle">Ian Dong</h2>

        <br><br>



        <div class="bounding-box">

            <h2 align="middle" id="5a">Overview</h2>

            In this first part of the project, I played around with the DeepFloyd IF diffusion model, implemented
            diffusion sampling loops, and then used them to create inpainted and optical illusions. I learned a lot
            about diffusion models and how they can be used to create cool effects on images.
            <br><br>
        </div>

        <br><br>

        <h2 align="middle">Section 0: Setup</h2>

        <div class="bounding-box">
            <h3 align="middle">
                Using the DeepFloyd IF Diffusion Model
            </h3>
            <p>
                For this part, I instantiated DeepFloyd's <code class="highlighter-rouge">stage_1</code> and <code
                    class="highlighter-rouge">stage_2</code> and passed in the following text prompts: <i>an oil
                    painting of a snowy mountain village, a man wearing a hat,</i> and <i> a rocket ship</i>. I set the
                seed to be 180 for all parts. Then, I varied the inference steps to generate the following images:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/setup/stage_1_mountain_20.png" align="middle" width="400px" />
                        <figcaption>Stage 1 (20 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_mountain_20.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (20 Stepss)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_1_mountain_50.png" align="middle" width="400px" />
                        <figcaption>Stage 1 (50 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_mountain_50.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (50 Steps)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/setup/stage_1_man_20.png" align="middle" width="400px" />
                        <figcaption>Stage 1 (20 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_man_20.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (20 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_1_man_50.png" align="middle" width="400px" />
                        <figcaption>Stage 1 (50 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_man_50.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (50 Steps)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/setup/stage_1_rocket_50.png" align="middle" width="400px" />
                        <figcaption>Stage 1 (20 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_rocket_50.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (20 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_1_rocket_20.png" align="middle" width="400px" />
                        <figcaption>OStage 1 (50 Steps)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/setup/stage_2_rocket_20.png" align="middle" width="400px" />
                        <figcaption>Stage 2 (50 Steps)</figcaption>
                    </td>

                </tr>
            </table>

            <p>
                The quality of the images becomes much more clearer after stage 2. It seems that all of the images fit
                the given prompt pretty well. For each of the prompts, as we increase the number of inference steps it
                seems that the images become much more detailed and fancy. For example in the man iwth the hat it looks
                more realistic and the snow has a lot more details with the shading.
            </p>
        </div>

        <br>
        <br>

        <h2 align="middle">Section I: Implementing the Forward Process</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Implementing the Forward Process
            </h3>
            <p>
                In this section, I implemented the forward process of the diffusion model to gradually add more noise to
                a clean image. The forward process is defined by:

                $$ q(x_{t} | x_{0}) = \mathcal{N}(X_{t}, \sqrt{\overline{\alpha}}x_{0}, (1 -
                \overline{\alpha}_{t})\mathbf{I})$$ which is equivalent to:

                $$x_{t} = \sqrt{\overline{\alpha}_{t}}x_{0} + \sqrt{1 - \overline{\alpha}_{t}} \epsilon \quad
                \text{where } \epsilon \sim \mathcal{N}(0, 1).$$ I sampled from a Gaussian distribution to add more
                noise to the original image. Here are the results:
            </p>

            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Campanile</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_250.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 250</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_500.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 500</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_750.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 750</figcaption>
                    </td>

                </tr>
            </table>
        </div>
        
        <br>
        <br>
        <h2 align="middle">Section II: Classical Denoising</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Classical Denoising
            </h3>
            <p>
                Then, I applied <i>Gaussian blur filtering</i> over the above images in an attempt to reduce the noise. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_250.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 250</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_500.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 500</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_750.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 750</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/gaussian_250.png" align="middle" width="400px" />
                        <figcaption>Gaussian Denoise Level = 250</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/gaussian_500.png" align="middle" width="400px" />
                        <figcaption>Gaussian Denoise Level = 500</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/gaussian_750.png" align="middle" width="400px" />
                        <figcaption>Gaussian Denoise Level = 750</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        
        <br>
        <br>
        <h2 align="middle">Section III: One-Step Denoising</h2>
        <div class="bounding-box">
            <h3 align="middle">
                One-Step Denoising
            </h3>
            <p>
                For the next step, I implemented the one-step denoising process by using the <code class="highlighter-rouge">stage_1.unet</code> to estimate the Gaussian noise and subtract it from the noisy images. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_250.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 250</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_500.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 500</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/noisy_image_750.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 750</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/estimate_250.png" align="middle" width="400px" />
                        <figcaption>Estimate of Original</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/estimate_500.png" align="middle" width="400px" />
                        <figcaption>Estimate of Original</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/estimate_750.png" align="middle" width="400px" />
                        <figcaption>Estimate of Original</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        
        <br>
        <br>
        <h2 align="middle">Section IV: Iterative Denoising</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Iterative Denoising
            </h3>
            <p>
                Finally, I implemented iterative denoising to further reduce the noise and get a better estimate. I used strided timesteps to speed things up and skip steps. The formula I used was:

                $$x_{t'} = \frac{\sqrt{\bar\alpha_{t'}}\beta_t}{1 - \bar\alpha_t} x_0 +
                \frac{\sqrt{\alpha_t}(1 - \bar\alpha_{t'})}{1 - \bar\alpha_t} x_t +
                v_\sigma$$

                This helps to move from a noiser image to a cleaner image similar to finding a linear interpolation between both of them. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/iterative_690.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 690</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/iterative_570.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 540</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/iterative_420.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 390</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/iterative_270.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 240 </figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/iterative_120.png" align="middle" width="400px" />
                        <figcaption>Noise Level = 90</figcaption>
                    </td>
                </tr>
            </table>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/final_iterative.png" align="middle" width="400px" />
                        <figcaption>Iteratively Denoised</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/one_step.png" align="middle" width="400px" />
                        <figcaption>One Step Denoised</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/gaussian_denoised.png" align="middle" width="400px" />
                        <figcaption>Gaussian Denoised </figcaption>
                    </td>
                </tr>
            </table>
        </div>
        
        <br>
        <br>
        <h2 align="middle">Section V: Diffusion Model Sampling</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Diffusion Model Sampling
            </h3>
            <p>
                In this section, I passed in random noise and used the <code class="highlighter-rouge">iterative_denoise</code> to effectively defnoise pure noise. This allows me to generate images from scratch by setting <code class="highlighter-rouge">i_start = 0</code>. Here are the results with the prompt = <i>a high quality photo</i>:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/GeneratedImages/image1.png" align="middle" width="400px" />
                        <figcaption>Image 1</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/image2.png" align="middle" width="400px" />
                        <figcaption>Image 2</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/image3.png" align="middle" width="400px" />
                        <figcaption>Image 3</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/image4.png" align="middle" width="400px" />
                        <figcaption>Image 4</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/image5.png" align="middle" width="400px" />
                        <figcaption>Image 5</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section VI: Classifier Free Guidance</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Classifier Free Guidance
            </h3>
            <p>
                In the previous section, the generated images did not have great quality. I used classifier free guidance to greatly improve image quality. First, I computed both a noise estimate on a text prompt and an unconditional noise estimate. I let the new noise estimate be:
                $$ \epsilon = \epsilon_u + \gamma(\epsilon_c - \epsilon_u)$$
                where $\gamma$ helps to control the strength of CFG. Here are the results with the prompt = <i>a high quality photo</i>:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/GeneratedImages/cfg_image1.png" align="middle" width="400px" />
                        <figcaption>CFG Image 1</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/cfg_image2.png" align="middle" width="400px" />
                        <figcaption>CFG Image 2</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/cfg_image3.png" align="middle" width="400px" />
                        <figcaption>CFG Image 3</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/cfg_image4.png" align="middle" width="400px" />
                        <figcaption>CFG Image 4</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/GeneratedImages/cfg_image5.png" align="middle" width="400px" />
                        <figcaption>CFG Image 5</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section VII: Image to Image Translation</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Image to Image Translation
            </h3>
            <p>
                In the previous sections, we can see that as we add noise we can make modifications to existing images. The greater the noise the more potential for edits. I took some original images, added noise to them, and then ran the forward process without any conditioning for a variety of starting indices. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/campanile_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/doe_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/moffitt_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <div class="bounding-box">
            <h3 align="middle">
                Editing Hand-Drawn and Web Images
            </h3>
            <p>
                I decided to try out the same approach above but on nonrealistic images. One of them was downloaded from the internet while the other two are hand-drawn images. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/tiger_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/tiger.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/dog_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/watermelon_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/watermelon.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <div class="bounding-box">
            <h3 align="middle">
                Inpainting
            </h3>
            <p>
                I used the same approach above to implement inpainting of images. Given an original image, $x_\text{orig}$ and a binary mask $m$, I can generate a new image that that retains the original content where $m = 0$, while generating new content in the regions where $m = 1$. I used the following expression to get the new image:
                $$x_{t} \leftarrow \mathbf{m}x_{t} + (1 - \mathbf{m})\text{forward}(x_{\text{orig}}, t)$$
                This helps to leave everything within the mask region untouched while only denoising and replacing everything outside of it with new content. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Campanile</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_mask.png" align="middle" width="400px" />
                        <figcaption>Mask</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_to_replace.png" align="middle" width="400px" />
                        <figcaption>To Replace</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_inpainted.png" align="middle" width="400px" />
                        <figcaption>Campanile Inpainted</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/doe.png" align="middle" width="400px" />
                        <figcaption>Doe Library</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_library_mask.png" align="middle" width="400px" />
                        <figcaption>Mask</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_to_replace.png" align="middle" width="400px" />
                        <figcaption>To Replace</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_library_inpainted.png" align="middle" width="400px" />
                        <figcaption>Doe Library Inpainted</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/moffitt.png" align="middle" width="400px" />
                        <figcaption>Moffitt Library</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_mask.png" align="middle" width="400px" />
                        <figcaption>Mask</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_to_replace.png" align="middle" width="400px" />
                        <figcaption>To Replace</figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_inpainted.png" align="middle" width="400px" />
                        <figcaption>Moffitt Inpainted</figcaption>
                    </td>
                </tr>
            </table>

            <p>
                In the first image, I made it so that the Campanile would look more like a lighthouse. Then I changed the Doe Library to look more like an oil painting by replacing the left side with a mountainous background. Finally, for Moffitt Library, I replaced the building with a cool looking red shed and a nice green scenery.
            </p>
        </div>

        <br>
        <div class="bounding-box">
            <h3 align="middle">
                Text-Conditional Image-to-image Translation
            </h3>
            <p>
                Afterwards, I followed the same procedure as above but instead will guide the projection using a text prompt. This means that it is no longer a pure "projection to the natural image manifold" anymore but also adds control using language. I changed the prompt from <i>a high quality photo</i> to <i>a rocket ship</i> for the Campanile image, <i>an oil painting of a snowy mountain village</i> for the Doe Library image, and finally <i>a lithograph of waterfalls</i> for the Moffitt Library image. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_rocket_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_rocket_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_rocket_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_rocket_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campanile_rocket_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/SamplingLoops/campanile.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe_mountain_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/doe.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_1.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=1</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_3.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=3</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_5.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=5</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_7.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=7</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_10.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=10</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt_waterfall_20.png" align="middle" width="400px" />
                        <figcaption><code class="highlighter-rouge">i_start=20</code></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/moffitt.png" align="middle" width="400px" />
                        <figcaption>Original</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section VIII: Visual Anagrams</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Visual Anagrams
            </h3>
            <p>
                In this section, I created an image what would look like a certain prompt but when flipped upside down it will look like a completely different prompt. To achieve this, I needed to take in two different prompts and calculate their respective estimated noise. These were the following equations I used:

                $$
                    \begin{align*}
                        \epsilon_1 &= \text{UNet}(x_t, t, p_1) \\
                        \epsilon_2 &= \text{flip}(\text{UNet}(\text{flip}(x_t), t, p_2)) \\
                        \epsilon &= (\epsilon_1 + \epsilon_2) / 2
                    \end{align*}
                $$
                By flipping the image and running the UNet on it, I am able to apply a reverse diffusion step to generate image on the opposite direction. Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/old_man_campfire.png" align="middle" width="400px" />
                        <figcaption><i>"An Oil Painting of an Old Man"</i></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/campfire_old_man.png" align="middle" width="400px" />
                        <figcaption><i>"An Oil Painting of People Around a Campfire</i></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/mountain_coast.png" align="middle" width="400px" />
                        <figcaption><i>"An Oil Painting of a Snowy Mountain Village</i></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/coast_mountain.png" align="middle" width="400px" />
                        <figcaption><i>"A Photo of the Amalfi Coast"</i></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/man_dog.png" align="middle" width="400px" />
                        <figcaption><i>"An Photo of a Man"</i></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/dog_man.png" align="middle" width="400px" />
                        <figcaption><i>"A Photo of a Dog"</i></figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section IX: Hybrid Images</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Hybrid Images
            </h3>
            <p>
                In this section, I implemented factorized diffusion to create hybrid images similar to project 2. I would take in two different prompts and then passed in the estimated noises into a low-pass filter and a high-pass filter. Afterwards, I used this as the final noise estimate. For the low-pass and high-pass filters, I simply used a Gaussian filter with a kernel size of 33 and sigma of 2. These were the following equations I used:

                $$
                    \begin{align*}
                        \epsilon_1 &= \text{UNet}(x_t, t, p_1) \\
                        \epsilon_2 &= \text{UNet}(x_t, t, p_2) \\
                        \epsilon &= f_\text{low pass}(\epsilon_1) + f_\text{high pass}(\epsilon_2)
                    \end{align*}
                $$
                Here are the results:
            </p>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/5a/Edits/hybrid_skull_waterfall.png" align="middle" width="400px" />
                        <figcaption><i>"Hybrid of Skull and Waterfall"</i></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/hybrid_mountain_man.png" align="middle" width="400px" />
                        <figcaption><i>"Hybrid of Snowy Mountain and Old Man</i></figcaption>
                    </td>
                    <td>
                        <img src="./Images/5a/Edits/hybrid_skull_dog.png" align="middle" width="400px" />
                        <figcaption><i>"Hybrid of Skull and Dog</i></figcaption>
                    </td>
                </tr>
            </table>
        </div>


        <br>
        <br>

        <h1 align="middle"><a href="#5b">Project 5B: Diffusion Models from Scratch</a>
        </h1>

        <div class="bounding-box">

            <h2 align="middle" id="5b">Overview</h2>

            The second part of this project focuses on building diffusion models from scratch to use on the MNIST dataset. I implemented a single-step denoising UNet and added time and class conditioning to iteratively denoise an image and get better results.
            <br><br>
        </div>

        <br>
        <br>

        <h2 align="middle">Section I: Detecting Corner Features in an Image</h2>

        <div class="bounding-box">
            <h3 align="middle">
                Harris Interest Point Detector
            </h3>
            <p>
                I used the <code class="highlighter-rouge">get_harris_corners</code> starter code to get the Harris
                points and
                identify corners within an image. This will be helpful in finding the feature points that we can use to
                match up
                the images. The Harris corner detection algorithm calculates the intensity gradients at a certain
                location which
                represent the rate of change in pixel intensities along the $x$ and $y$ directions and thus the edges
                and
                corners that have sharp intensity changes. I also filtered out the corners by setting a threshold on the
                corner
                response value and overlaid them on the images. Here are the results:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/sink/sink_left.jpg" align="middle" width="400px" />
                        <figcaption>Sink Left (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/sink/sink_left.png" align="middle" width="400px" />
                        <figcaption>Sink Left (Harris)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4a/sink/sink_right.jpg" align="middle" width="400px" />
                        <figcaption>Sink Right (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/sink/sink_right.png" align="middle" width="400px" />
                        <figcaption>Sink Right (Harris)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/outside/outside_left.jpg" align="middle" width="400px" />
                        <figcaption>Outside Left (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/outside/outside_left.png" align="middle" width="400px" />
                        <figcaption>Outside Left (Harris)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4a/outside/outside_right.jpg" align="middle" width="400px" />
                        <figcaption>Outside Right (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/outside/outside_right.png" align="middle" width="400px" />
                        <figcaption>Outside Right (Harris)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/campanile/campanile_left.jpg" align="middle" width="400px" />
                        <figcaption>Campanile Left (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/campanile/campanile_left.png" align="middle" width="400px" />
                        <figcaption>Campanile Left (Harris)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4a/campanile/campanile_right.jpg" align="middle" width="400px" />
                        <figcaption>Campanile Right (Original)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/campanile/campanile_right.png" align="middle" width="400px" />
                        <figcaption>Campanile Right (Harris)</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>

        <h2 align="middle">Section II: Adaptive Non-Maximal Suppression</h2>

        <div class="bounding-box">
            <h3 align="middle">
                ANMS Algorithm
            </h3>
            <p>
                As shown above, there were a lot of different corner points. I wanted to distribute the points more
                evenly
                around the images. First, I found the distances between each pair of points from the two different
                images. Then,
                I sorted by the corner response value. For each point in the first image, I calculated the suppression
                radius
                using the following formula:

                $$ r_i = \min_j |x_i - x_j|, \text{ s.t. } f(x_i) < c_{\text{robust}} \cdot f(x_j)$$ Finally, I sorted
                    the points by their suppression radius and selected the $n$ points with the largest radius. This way
                    I could get a better spatial distribution of the points. Here are the results: </p>
                    <div align="middle"></div>
                    <table>
                        <tr align="center">
                            <td>
                                <img src="./Images/4b/sink/sink_left_anms.png" align="middle" width="400px" />
                                <figcaption>Sink Left (ANMS)</figcaption>
                            </td>
                            <td>
                                <img src="./Images/4b/sink/sink_right_anms.png" align="middle" width="400px" />
                                <figcaption>Sink Right (ANMS)</figcaption>
                            </td>
                        </tr>
                        <tr align="center">
                            <td>
                                <img src="./Images/4b/outside/outside_left_anms.png" align="middle" width="400px" />
                                <figcaption>Outside Left (ANMS)</figcaption>
                            </td>
                            <td>
                                <img src="./Images/4b/outside/outside_right_anms.png" align="middle" width="400px" />
                                <figcaption>Outside Right (ANMS)</figcaption>
                            </td>
                        </tr>
                        <tr align="center">
                            <td>
                                <img src="./Images/4b/campanile/campanile_left_anms.png" align="middle" width="400px" />
                                <figcaption>Campanile Left (ANMS)</figcaption>
                            </td>
                            <td>
                                <img src="./Images/4b/campanile/campanile_right_anms.png" align="middle"
                                    width="400px" />
                                <figcaption>Campanile Right (ANMS)</figcaption>
                            </td>
                        </tr>
                    </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section III: Extracting Feature Descriptors</h2>

        <div class="bounding-box">
            <h3 align="middle">
                Extracting Feature Descriptors
            </h3>
            <p>
                For each of the ANMS points from before, I took a 40 by 40 patch centered at the point and then
                downsampled into
                8 by 8 mini-patch. Afterwards, I normalized the mini-patch (0 mean and unit variance) and then flattened
                into a
                vector. Here are the results:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/feature-descriptor/fd1.png" align="middle" width="400px" />
                        <figcaption>40 x 40 Patch</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/feature-descriptor/fd1_mini.png" align="middle" width="400px" />
                        <figcaption>8 x 8 Mini-Patch</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/feature-descriptor/fd2.png" align="middle" width="400px" />
                        <figcaption>40 x 40 Patch</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/feature-descriptor/fd2_mini.png" align="middle" width="400px" />
                        <figcaption>8 x 8 Mini-Patch</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section IV: Matching Feature Descriptors</h2>

        <div class="bounding-box">
            <h3 align="middle">
                Matching Feature Descriptors
            </h3>
            <p>
                With the flattened feature descriptors, I would be able to find the best matches between the images. I
                followed
                along with the algorithm in this <a
                    href="https://inst.eecs.berkeley.edu/~cs180/fa24/hw/proj4/Papers/MOPS.pdf">research paper</a>.
                First, I used
                the provided <code class="highlighter-rouge">dist2</code> function to calculate the SSD between each
                pair of
                points from image 1 and image 2. Then, I found the Lowe's score for each point in image 1 which is the
                ratio of
                1-NN distance to 2-NN distance. If the Lowe's score we below a certain a threshold, I added the point
                and its
                1-NN to the matches. Finally, I plotted each point in image 1 with its corresponding 1-NN in image 2.
                Here are the results:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/sink/sink_matching_points.png" align="middle" width="400px" />
                        <figcaption>Sink Matching Feature Descriptors</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/outside/outside_matching_points.png" align="middle" width="400px" />
                        <figcaption>Outside Matching Feature Descriptors</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/campanile/campanile_matching_points.png" align="middle" width="400px" />
                        <figcaption>Campanile Matching Feature Descriptors</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>
        <h2 align="middle">Section V: Running RANSAC</h2>

        <div class="bounding-box">
            <h3 align="middle">
                RANSAC
            </h3>
            <p>
                As shown above in the matching feature descriptors, there were some points that were not matched
                correctly. I
                used the RANSAC algorithm to further improve the number of matches and find the best ones to compute the
                homography matrix. These are the following steps I took:

            <ol>
                <li>Randomly select 4 pairs of points from the matches.</li>
                <li>Compute the homography matrix using the 4 pairs of points.</li>
                <li>Warp the points from image 1 to image 2 using the homography matrix.</li>
                <li>Calculate the SSD between the warped points and the points in image 2.</li>
                <li>Count the number of inliers where the SSD is below a certain threshold.</li>
                <li>Repeat steps 1-5 for a certain number of iterations.</li>
                <li>Recompute the approximate homography using the set of the largest inliers.</li>
            </ol>

            I plotted the selected inliers onto their respective images and the warped left image into the right image's
            perspective. Here are the results:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/sink/sink_left_subset.png" align="middle" width="400px" />
                        <figcaption>Sink Left Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/sink/sink_right_subset.png" align="middle" width="400px" />
                        <figcaption>Sink Right Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/sink/sink_left_warped_auto_stitched.jpg" align="middle" width="400px" />
                        <figcaption>Sink Left (Warped)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/outside/outside_left_subset.png" align="middle" width="400px" />
                        <figcaption>Outside Left Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/outside/outside_right_subset.png" align="middle" width="400px" />
                        <figcaption>Outside Right Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/outside/outside_left_warped_auto_stitched.jpg" align="middle"
                            width="400px" />
                        <figcaption>Outside Left (Warped)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4b/campanile/campanile_left_subset.png" align="middle" width="400px" />
                        <figcaption>Campanile Left Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/campanile/campanile_right_subset.png" align="middle" width="400px" />
                        <figcaption>Campanile Right Subset</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/campanile/campanile_left_warped_auto_stitched.jpg" align="middle"
                            width="400px" />
                        <figcaption>Campanile Left (Warped)</figcaption>
                    </td>
                </tr>
            </table>
        </div>
        <br>
        <br>

        <h2 align="middle">Section VI: Producing the Mosaic and Comparisons</h2>

        <div class="bounding-box">
            <h3 align="middle">
                Mosaic Comparison
            </h3>
            <p>
                Using the above 4-point RANSAC algorithm, I auto-stitched together the images to create a seamless
                mosaic
                without predefining the correspondences. I also compared them to Part A's mosaics where I manually
                created the
                correspondences. As shown below, the auto-stitched mosaics found better homographies as there are fewer
                artifacts and blurriness compared to the manual defined mosaics. Here are the results:
            </p>
            <div align="middle"></div>
            <table>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/sink/sink_mosaic_final.jpg" align="middle" width="400px" />
                        <figcaption>Sink Mosaic (Predefined Points)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/sink/sink_mosaic_auto_stitched.jpg" align="middle" width="400px" />
                        <figcaption>Sink Mosaic (Auto-Stitched Points)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/outside/outside_mosaic_final.jpg" align="middle" width="400px" />
                        <figcaption>Outside Mosaic (Predefined Points)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/outside/outside_mosaic_auto_stitched.jpg" align="middle" width="400px" />
                        <figcaption>Outside Mosaic (Auto-Stitched Points)</figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="./Images/4a/campanile/campanile_mosaic_final.jpg" align="middle" width="400px" />
                        <figcaption>Campanile Mosaic (Predefined Points)</figcaption>
                    </td>
                    <td>
                        <img src="./Images/4b/campanile/campanile_mosaic_auto_stitched.jpg" align="middle"
                            width="400px" />
                        <figcaption>Campanile Mosaic (Auto-Stitched Points)</figcaption>
                    </td>
                </tr>
            </table>
        </div>

        <br>
        <br>

        <h2 align="middle">Section VII: Conclusion</h2>
        <div class="bounding-box">
            <h3 align="middle">
                Learnings
            </h3>
            <p>
                I learned a lot about finetuning and filtering out the Harris corners especially to get a better spatial
                distribution on the images. Throughout this process, I made sure to note down what order my points in
                whether as
                (row, col) or (y, x). This way when I'm plotting and calculating the homography matrix I would get the
                correct
                results. The coolest takeaway was finding the best matches to automatically stitch together the images.
            </p>
        </div>

</body>

</html>